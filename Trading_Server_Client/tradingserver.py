import socket

prices = [18.8846,
18.8846,
18.8846,
18.88614,
18.88728,
18.88689,
18.88728,
18.88689,
18.88688,
18.88729,
18.88729,
18.88689,
18.88688,
18.88689,
18.88688,
18.88688,
18.88688,
18.88688,
18.88688,
18.88688,
18.88689,
18.88688,
18.88688,
18.88689,
18.88689,
18.88689,
18.88688,
18.88688,
18.88688,
18.88689,
18.88689,
18.88689,
18.88689,
18.88688,
18.88689,
18.88688,
18.88689,
18.88688,
18.88689,
18.88689,
18.88689,
18.88688,
18.88688,
18.88688,
18.88688,
18.88688,
18.90354,
18.91942,
18.91852,
18.91861,
18.91788,
18.91821,
18.91731,
18.91786,
18.9114,
18.90988,
18.93088,
18.93048,
18.93008,
18.93008,
18.93008,
18.93008,
18.93008,
18.93008,
18.93008,
18.93008,
18.9305,
18.9305,
18.9305,
18.92978,
18.92978,
18.92978,
18.92978,
18.92978,
18.93118,
18.93118,
18.93148,
18.93148,
18.93128,
18.93118,
18.93118,
18.93118,
18.93118,
18.93041,
18.93118,
18.93118,
18.93098,
18.93118,
18.93118,
18.93118,
18.93113,
18.93008,
18.93118,
18.93118,
18.93118,
18.92758,
18.92688,
18.92658,
18.92658,
18.92658,
18.92658,
18.92658,
18.92658,
18.92658,
18.92658,
18.92658,
18.92658,
18.9269,
18.9269,
18.9269,
18.9269,
18.92658,
18.92688,
18.92658,
18.92658,
18.9295,
18.9295,
18.9295,
18.92878,
18.92868,
18.92868,
18.92878,
18.92868,
18.92848,
18.92878,
18.92868,
18.92878,
18.92878,
18.92928,
18.92828,
18.92818,
18.92838,
18.92818,
18.92758,
18.92738,]

intervals = len(prices)
i = -1

host = '127.0.0.1'
port = 631

server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
server.bind((host,port))
print(host, ", ", port, "     [*]Bind Established, (host,port)")
print("Listening....")

server.listen(1)
conn, address = server.accept()

print(conn, ",", address, "     [*]Connection Established, (conn, address)")

while True:

    try:
        i = i+1
        data = prices[i]
        datas = str(data)
    except:
        print("End of Day")
        break

    try:
        server.listen(1)
        sending_data = conn.recv(1024)
    except:
        print("Connection Lost", conn , ", ", address)
        print("Failed to Send Market Price")

    try:
        if(sending_data == '0'):
            conn.send(datas)
        else:
            print("Client Refused Market Price")
            print("Failed to Send Market Price")

    except:
        print("Server Error")
        print("Failed to Send Market price")



print("\n\n\nEnd")

